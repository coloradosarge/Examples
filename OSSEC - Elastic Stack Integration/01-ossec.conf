match => { "message" => ".* +Alert +Level: +%{POSINT:ossec_alert_level}; +Rule: +%{POSINT:ossec_rule_num} +- +%{DATA:ossec_rule_name}; +Location: +(\(%{DATA:ossec_src_host}\))? *%{DATA:ossec_from}->%{DATA:ossec_to}; +%{GREEDYDATA:ossec_message} "}
match => { "message" => ".* +Alert +Level: +%{POSINT:ossec_alert_level}; +Rule: +%{POSINT:ossec_rule_num} +- +%{DATA:ossec_rule_name}; +Location: +\(%{DATA:ossec_src_host}\) +%{DATA:ossec_from}->%{DATA:ossec_to}; +%{GREEDYDATA:ossec_message} "}
match => { "message" => ".* +Alert +Level: +%{POSINT:ossec_alert_level}; +Rule: +%{POSINT:ossec_rule_num} +- +%{DATA:ossec_rule_name}; +Location: +(\(%{DATA:ossec_src_host}\)) +%{DATA:ossec_from}->%{DATA:ossec_to};  +%{GREEDYDATA:ossec_message} "}
match => { "message" => ".* +Alert +Level: +%{POSINT:ossec_alert_level}; +Rule: +%{POSINT:ossec_rule_num} +- +%{DATA:ossec_rule_name}; +%{DATA:ossec_from}->%{DATA:ossec_to};  +%{GREEDYDATA:ossec_message} "}
match => { "message" => ".* +Alert +Level: +%{POSINT:ossec_alert_level}; +Rule: +%{POSINT:ossec_rule_num} +- +%{DATA:ossec_rule_name}; +Location: +\(%{DATA:ossec_src_host}\) +%{DATA:ossec_from}->%{DATA:ossec_to}; +%{GREEDYDATA:ossec_message} "}
match => { "message" => ".* +Alert +Level: +%{POSINT:ossec_alert_level}; +Rule: +%{POSINT:ossec_rule_num} +- +%{DATA:ossec_rule_name}; +Location: +%{DATA:ossec_from}->%{DATA:ossec_to};  +%{GREEDYDATA:ossec_message} "}
match => { "message" => ".*srcip: +%{DATA:ossec_srcip};.* "}
match => { "message" => ".*user: +%{DATA:ossec_user};.* "}
match => { "message" => ".* +%{OSSECSYSLOGSRC:ossec_log_src}: +session +opened +for +user +%{USERNAME:ossec_user} +by +\(uid\=%{INT:ossec_uid}\).* "}
match => { "message" => ".* +%{OSSECSYSLOGSRC:ossec_log_src}: +session +closed +for +user +%{USERNAME:ossec_user}.* "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{WINEVENTTYPE:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.* +%{DATA:ossec_win_evt_desc}. +Subject: +Security +ID: +%{WINSID:ossec_win_sid} +Account +Name: +%{WINUSERNAME:ossec_win_user_name} +Account +Domain: +%{DATA:ossec_win_domain} +Logon +ID:.* +Logon +Type: +%{DATA:ossec_win_login_type}:.* +Account +Name:.* +Account +Domain:.* +Logon +ID:.* +Logon +GUID:.* +Process +Information: +Process +ID: +%{DATA:ossec_win_process_id} +Process +Name: +%{WINPATH:ossec_win_process_name} +Network +Information.* +This +event +is +generated +when +a +logon +session +is +created.* "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{WINEVENTTYPE:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.*: +%{DATA:ossec_win_evt_desc}. ++Subject: +Security +ID: +%{WINSID:ossec_win_sid} +Account +Name: +%{WINUSERNAME:ossec_win_user_name} +Account +Domain: +%{DATA:ossec_win_domain} +Logon +ID:.* +Logon +Type: +%{POSINT:ossec_win_login_type}.* +This +event +is +generated +when +a +logon +session +is +destroyed.* "}
match => { "message" => ".* +imap-login: +Login: +user=<%{DATA:ossec_dovecot_username}>, +method=%{DATA:ossec_dovecot_method}, +rip=%{DATA:ossec_dovecot_remote_ip}, +lip=%{DATA:ossec_dovecot_local_ip},.*session=<%{DATA:ossec_dovecot_session_id}>.* "}
match => { "message" => ".* +getaddrinfo +for +%{DATA:ossec_dns_lookup_record} +.* "}
match => { "message" => ".* +PAM .* +more +authentication +failures;.* +ruser=%{DATA:ossec_ruser} .* "}
match => { "message" => ".* +PAM .* +more +authentication +failures;.* +rhost=%{DATA:ossec_rhost} .* "}
match => { "message" => ".* +PAM .* +more +authentication +failures;.* +user=%{GREEDYDATA:ossec_from_user}.* "}
match => { "message" => ".* +Previous +MD5: +'%{WORD:ossec_from_md5}'; +Current +MD5: +'%{WORD:ossec_to_md5}'; +Previous +SHA1: +'%{WORD:ossec_from_sha1}'; +Current +SHA1: +'%{WORD:ossec_to_sha1}';.* +'%{UNIXPATH:ossec_file_changed}'.* "}
match => { "message" => ".* +resolving +%{DATA:ossec_dns_lookup_record}':.* "}
match => { "message" => ".* +Windows +error +event.* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{WINEVENTTYPE:ossec_win_evt_type}:.* "}
match => { "message" => ".* +WinEvtLog: +%{WORD:ossec_win_evt_src}: +%{WINEVENTTYPE:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.* +Security +ID: +%{WINSID:ossec_win_sid} +Account +Name: +%{WINUSERNAME:ossec_win_user_name} +Account +Domain: +%{HOSTNAME:ossec_win_domain} +Logon +ID:.* +Object: +Object +Server: +Security +Object +Type: +%{DATA:ossec_win_object_type} +Object +Name: +%{WINPATH:ossec_win_object_name} +Handle +ID: +%{DATA:ossec_win_handle_id} +Process +Information: +Process +ID: %{DATA:ossec_win_process_id} +Process +Name: +%{DATA:ossec_win_process_name +} +.* "}
match => { "message" => ".* +Connection +blocked +by +Tcp +Wrappers.;.* +from .*\(%{DATA:ossec_srcip}\).* "}
match => { "message" => ".* +Possible +attack +on +the +ssh +server.* +from +%{DATA:ossec_srcip} +port.* "}
match => { "message" => ".* +Previous +MD5: +'%{WORD:ossec_from_md5}'; +Current +MD5: +'%{WORD:ossec_to_md5}'; +Previous +SHA1: +'%{WORD:ossec_from_sha1}'; +Current +SHA1: +'%{WORD:ossec_to_sha1}'; .* +for: +'%{WINREGISTRY:ossec_registry_changed}'.* "}
match => { "message" => ".* +[o|O]ssec +agent.* +'%{DATA:ossec_agent_src}'.* "}
match => { "message" => ".* +File +deleted.* +File +'%{DATA:ossec_file}'.* "}
match => { "message" => ".* +\(inode +changed\): +'%{DATA:ossec_file}'.* "}
match => { "message" => ".* +Yum.* +(Installed|Erased|Updated): +[\d\s:]*%{GREEDYDATA:ossec_package}.* "}
match => { "message" => ".* forbidden +file +or +directory.* +configuration: %{UNIXPATH:ossec_file}.* "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{WINEVENTTYPE:ossec_win_evt_type}: +%{GREEDYDATA:ossec_win_log_message}.* "}
match => { "message" => ".* +New +group +added.* +new +group: +name\=%{USERNAME:ossec_group}.* "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{WINEVENTTYPE:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.*: +%{DATA:osec_win_evt_desc}. +Subject: +Security +ID: +%{WINSID:ossec_win_sid} +Account +Name: +%{DATA:ossec_win_user_name} +Account +Domain: +%{DATA:ossec_win_domain} +Logon +ID: +%{DATA} +Logon +Type: +%{DATA:ossec_win_logon_type}: +Security +ID:.* +Process +Information: +Process +ID: +%{DATA:ossec_win_process_id} +Process +Name: +%{WINPATH:ossec_win_process_name} +Network +Information.* +This +event +is +generated +when +a +logon +session +is +created\. "}
match => { "message" => ".* +new +user: +name\=%{USERNAME:ossec_user}, +UID\=%{POSINT:ossec_user_id}, +GID\=%{POSINT:ossec_group_id}, +home\=%{DATA:ossec_user_home} +shell\=%{DATA:ossec_logon_shell}$ "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{DATA:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.* +Subject: +Security +ID: +%{DATA:ossec_win_sid} +Account +Name: +%{DATA:ossec_win_user_name} +Account +Domain: +%{DATA:ossec_win_domain} +Logon +ID:.* +Target +Account: +Security +ID: +%{DATA:ossec_win_target_sid} +Account +Name: +%{DATA:ossec_win_target_user_name} Account.* +Changed +Attributes: +%{GREEDYDATA:ossec_win_user_change_attributes} "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{DATA:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.* +Subject: +Security +ID: +%{DATA:ossec_win_sid} +Account +Name: +%{DATA:ossec_win_user_name} +Account +Domain: +%{DATA:ossec_win_domain} +Logon +ID:.* +Process +ID: +%{DATA:ossec_win_process_id} +Name: +%{GREEDYDATA:ossec_time_change_log}$ "}
match => { "message" => ".* +%{DATA:ossec_from_user} +: +TTY\=%{DATA:ossec_tty} +; +PWD\=%{DATA:ossec_pwd} +; +USER\=%{DATA:ossec_to_user} +; +COMMAND\=%{GREEDYDATA:ossec_command}.* "}
match => { "message" => ".* +imap-login: +%{DATA:ossec_dovecot_message}: +user\=<(%{DATA:ossec_dovcot_username})?>, rip=%{DATA:ossec_dovecot_remote_ip}, +lip=%{DATA:ossec_dovecot_local_ip},.*session=<%{DATA:ossec_dovecot_session_id}>.* "}
match => { "message" => ".* +auth-worker\(.*\): +pam\(%{DATA:ossec_dovecot_username},%{DATA:ossec_srcip}(,<%{DATA:ossec_dovecot_session_id}>)?\): +unknown +user.* "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{WINEVENTTYPE:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.* +Subject: +Security +ID: +%{WINSID:ossec_win_sid} +Account +Name: +%{DATA:ossec_win_user_name} +Account +Domain: +%{DATA:ossec_win_domain} +Logon +ID:.* +(Target|New) +Account: +Security +ID: +%{DATA:ossec_win_target_sid} +Account +Name: +%{DATA:ossec_win_target_user_name} +Account +Domain: +%{GREEDYDATA:ossec_win_user_change_attributes} "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{DATA:ossec_win_evt_type}: Microsoft-Windows-Security-Auditing:.* .+Subject: +Security +ID: +%{DATA:ossec_win_sid} +Account +Name: +%{DATA:ossec_win_user_name} +Account +Domain: +%{DATA:ossec_win_domain} +Logon +ID:.* +Member: +Security +ID: +%{DATA:ossec_win_target_sid} +Account +Name: +%{DATA:ossec_win_target_user_name} +Group: +Security +ID:.* +Group +Name:.* +Group +Domain:.* +Additional +Information: ( +%{GREEDYDATA:ossec_win_user_change_attributes})? "}
match => { "message" => ".* +WinEvtLog: +%{DATA:ossec_win_evt_src}: +%{DATA:ossec_win_evt_type}: +.*: +Product: %{DATA:ossec_application} +--.* "}
match => { "message" => ".*; +ossec: +output: +'.*': +%{DATA:ossec_disk} +%{DATA:ossec_size} +%{DATA:ossec_used} +%{DATA:ossec_percent_available} +%{DATA:ossec_percent_used} +%{DATA:ossec_mountpoint}$ "}
match => { "message" => ".* +Authentication +failure +for +%{DATA:ossec_user} +\(invoked +by +uid +%{DATA:ossec_uid}\).* "}
match => { "message" => ".* +FAILED +SU +\(to %{DATA:ossec_user}\) +%{DATA:ossec_from_user} +on %{DATA:ossec_term}$ "}
match => { "message" => ".* +password +changed +for +%{DATA:ossec_user}$ "}
match => { "message" => ".* +Did +not +receive +identification +string +from +%{DATA:ossec_srcip} port.* "}
match => { "message" => ".* +Invalid +user +%{DATA:ossec_user} +from %{DATA:ossec_srcip}$ "}
match => { "message" => ".*SSL_do_handshake().*client: +%{DATA:ossec_srcip},.* "}
match => { "message" => ".*useradd\[\d*\]: +new +group: +name\=%{DATA:ossec_user}, +GID\=%{DATA:ossec_gid}$ "}
